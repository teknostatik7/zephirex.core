// Get balances through authedClient.
const authedClient = require('authedClient');

function getBalances(){
	return new Promise(resolve => {
		console.log("Commence balance update")
		var accounts = authedClient.getAccounts();
		accounts.then(function(jsObjects) {
			let results = jsObjects.filter(obj => {
			  return obj.available > 0;
			})
			//console.log(results);
			for (var i = 0; i < results.length; i++) {
				asset = results[i];
				window.balances[asset.currency] = asset.available;
				window.balanceSheet += asset.currency + ": " + asset.available + '\r';
				//console.log(asset.currency + " available: " + asset.available);
			}
			resolve('== Balances updated ==');
		}).catch(err => {
			console.log("Get balances error:");
			console.log(err);
		});
	})
}

module.exports = getBalances;