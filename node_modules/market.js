const f = require('f');

// Market Object

function market(quoteName, baseName){
	this.name = quoteName + "-" + baseName;
	this.baseName = baseName;
	this.quoteName = quoteName;
	this.quoteBalance = window.balances[this.quoteName];
	this.baseBalance = window.balances[this.baseName];
	this.minQuote = null;
	this.minBase = null;
	this.disable = 0;

	this.calculate = function(balance, close, open, precision){

		var r = parseFloat(window.xFactor * Math.sqrt((2*balance)/Math.PI)).toFixed(8);
		var t = Math.PI;

		var maxTotalArea = parseFloat(2 * r * r * t).toFixed(8); // 2πr²
		var percentChange = (close - open) / open;

		var maxSectionArea = parseFloat(2 * r * r * Math.abs(percentChange) * Math.PI).toFixed(8);

		var t2 = parseFloat((1 - Math.abs(percentChange)) * t).toFixed(8);

		//console.log(r);
		var fullArea = f(r, t);
		var stop = f(r, t2);
		var differenceArea = Number(fullArea - stop - maxSectionArea);

		return parseFloat(differenceArea * window.minMultiplier).toFixed(precision);
	}
}

module.exports = market;

